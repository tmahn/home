set +e

# X-Win32 seems to reset a bunch of internal state if it ever gets down to
# zero clients. So we keep a dummy one active at all times.
xdummyclient &
disown "${!}"

FONT_DIR=~/.fonts
if [ -d "${FONT_DIR}" ]; then
    #  Xming needs windows paths
    if [ "$OSTYPE" = "cygwin" ] && xdpyinfo |grep -q 'Colin Harrison'; then
        FONT_DIR="$(cygpath -w "${FONT_DIR}")"
    fi
    xset +fp "${FONT_DIR}"
fi

xset b off # shitcan the freaking bell
# xset r off
xrdb ~/.Xresources
xsetroot -solid grey
xmodmap ~/.Xmodmap
if xmodmap -pke |grep -q Terminate_Server; then
    xmessage "The Terminate_Server key is bound. You will regret that."
    exit 1
fi

make -C ~/.xkb install

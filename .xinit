set +e

# X-Win32 raises a bunch of “allow this connection?” pop-ups when this runs
# automatically at startup which I’m guessing has something to do with the
# fact that there aren’t any windows on screen yet.
xmessage -timeout 10 -buttons '' "Welcome to X!" &
sleep 2

FONT_DIR=~/.fonts
if [ -d "${FONT_DIR}" ]; then
    #  Xming needs windows paths
    if [ "$OSTYPE" = "cygwin" ] && xdpyinfo |grep -q 'Colin Harrison'; then
        FONT_DIR="$(cygpath -w "${FONT_DIR}")"
    fi
    xset +fp "${FONT_DIR}"
fi

xset b off # shitcan the freaking bell
# xset r off
xrdb ~/.Xresources
xsetroot -solid grey
xmodmap ~/.Xmodmap
if xmodmap -pke |grep -q Terminate_Server; then
    xmessage "The Terminate_Server key is bound. You will regret that."
    exit 1
fi

make -C ~/.xkb install

#!/usr/bin/env python2.7
# coding: UTF-8

import re
import subprocess

# generated by running “tlmgr list --only-installed” right after install
DEFAULT_OUTPUT = """
i ae: Virtual fonts for T1 encoded CMR-fonts.
i amscls: AMS document classes for LaTeX.
i amsfonts: TeX fonts from the American Mathematical Society.
i amsmath: AMS mathematical facilities for LaTeX.
i anysize: A simple package to set up document margins.
i arabxetex: An ArabTeX-like interface for XeLaTeX.
i auto-pst-pdf: Wrapper for pst-pdf (with some psfrag features).
i automata: Finite state machines, graphs and trees in MetaPost.
i babel: Multilingual support for Plain TeX or LaTeX.
i babelbib: Multilingual bibliographies.
i bbcard: Bullshit bingo, calendar and baseball-score cards.
i bclogo: Creating colourful boxes with logos.
i beamer: A LaTeX class for producing presentations and slides.
i bibtex: Process bibliographies for LaTeX, etc.
i bibtex.universal-darwin: universal-darwin files of bibtex
i blockdraw_mp: Block diagrams and bond graphs, with MetaPost.
i booktabs: Publication quality tables in LaTeX
i bpolynomial: Drawing polynomial functions of up to order 3.
i caption: Customising captions in floating environments.
i carlisle: David Carlisle's small packages.
i cite: Improved citation handling in LaTeX.
i cm: Computer Modern fonts.
i cmap: Make PDF files searchable and copyable.
i cmarrows: MetaPost arrows and braces in the Computer Modern style.
i collection-basic: Essential programs and files
i collection-documentation-base: TeX Live documentation
i collection-genericrecommended: Recommended generic packages
i collection-latex: Basic LaTeX packages
i collection-latexrecommended: LaTeX recommended packages
i collection-metapost: MetaPost (and Metafont) drawing packages
i collection-pstricks: PSTricks packages
i collection-xetex: XeTeX packages
i colortbl: Add colour to LaTeX tables.
i crop: Support for cropmarks.
i ctable: Easily typeset centered tables.
i drv: Derivation trees with MetaPost.
i dviincl: Include a DVI page into MetaPost output.
i dvipdfm: A DVI driver to produce PDF directly.
i dvipdfm.universal-darwin: universal-darwin files of dvipdfm
i dvipdfmx: An extended version of dvipdfm.
i dvipdfmx-def: Configuration file for dvipdfmx graphics.
i dvipdfmx.universal-darwin: universal-darwin files of dvipdfmx
i dvips: A DVI to PostScript driver.
i dvips.universal-darwin: universal-darwin files of dvips
i ec: Computer modern fonts in T1 and TS1 encodings.
i emp: "Encapsulate" MetaPost figures in a document.
i enctex: A TeX extension that translates input on its way into TeX.
i epsf: Simple macros for EPS inclusion.
i epsincl: Include EPS in MetaPost figures.
i eso-pic: Add picture commands (or backgrounds) to every page.
i etex: An extended version of TeX, from the NTS project.
i etex-pkg: E-TeX support package.
i euenc: Unicode font encoding definitions for XeTeX.
i euler: Use AMS Euler fonts for math.
i expressg: Diagrams consisting of boxes, lines, and annotations.
i exteps: Include EPS figures in MetaPost.
i extsizes: Extend the standard classes' size options.
i fancybox: Variants of \fbox and other games with boxes.
i fancyhdr: Extensive control of page headers and footers in LaTeX2e.
i fancyref: A LaTeX package for fancy cross-referencing.
i fancyvrb: Sophisticated verbatim text.
i featpost: MetaPost macros for 3D.
i feynmf: Macros and fonts for creating Feynman (and other) diagrams.
i fix2col: Fix miscellaneous two column mode features.
i fixlatvian: Improve Latvian language support in XeLaTeX.
i float: Improved interface for floating objects.
i fontbook: Generate a font book.
i fontname: Scheme for naming fonts in TeX.
i fontspec: Advanced font selection in XeLaTeX and LuaLaTeX.
i fontwrap: Bind fonts to specific unicode blocks.
i fp: Fixed point arithmetic.
i garrigues: MetaPost macros for the reproduction of Garrigues' Easter nomogram.
i genmisc: (shortdesc missing)
i geometry: Flexible and complete interface to document dimensions.
i glyphlist: (shortdesc missing)
i gmp: Allow integration between MetaPost pictures and LaTeX.
i graphics: Standard LaTeX graphics.
i gsftopk: Convert "ghostscript fonts" to PK files.
i gsftopk.universal-darwin: universal-darwin files of gsftopk
i hatching: MetaPost macros for hatching interior of closed paths.
i hyperref: Extensive support for hypertext in LaTeX.
i hyph-utf8: Hyphenation patterns expressed in UTF-8.
i hyphen-base: (shortdesc missing)
i hyphen-basque: Basque hyphenation patterns.
i hyphen-danish: Danish hyphenation patterns.
i hyphen-dutch: Dutch hyphenation patterns.
i hyphen-finnish: Finnish hyphenation patterns.
i hyphen-french: French hyphenation patterns.
i hyphen-german: German hyphenation patterns.
i hyphen-hungarian: Hungarian hyphenation patterns.
i hyphen-italian: Italian hyphenation patterns.
i hyphen-norwegian: Norwegian Bokmal and Nynorsk hyphenation patterns.
i hyphen-polish: Polish hyphenation patterns.
i hyphen-portuguese: Portuguese hyphenation patterns.
i hyphen-spanish: Spanish hyphenation patterns.
i hyphen-swedish: Swedish hyphenation patterns.
i ifluatex: Provides the \ifluatex switch.
i ifxetex: Am I running under XeTeX?
i index: Extended index for LaTeX including multiple indexes.
i jknapltx: Miscellaneous packages by Joerg Knappen.
i kastrup: Convert numbers into binary, octal and hexadecimal.
i koma-script: A bundle of versatile classes and packages
i kpathsea: Path searching library for TeX-related files.
i kpathsea.universal-darwin: universal-darwin files of kpathsea
i l3experimental: Experimental LaTeX3 concepts.
i l3kernel: LaTeX3 programming conventions.
i l3packages: High-level LaTeX3 concepts.
i latex: A TeX macro package that defines LaTeX.
i latex-bin: LaTeX executables and man pages.
i latex-bin.universal-darwin: universal-darwin files of latex-bin
i latex-fonts: A collection of fonts used in LaTeX distributions.
i latexconfig: (shortdesc missing)
i latexmp: Interface for LaTeX-based typesetting in MetaPost
i listings: Typeset source code listings using LaTeX.
i ltxmisc: Miscellaneous LaTeX packages, etc.
i lua-alt-getopt: Process application arguments the same way as getopt_long.
i lualibs: Additional Lua functions for LuaTeX macro programmers.
i luaotfload.universal-darwin: universal-darwin files of luaotfload
i luatex: The LuaTeX engine.
i luatex.universal-darwin: universal-darwin files of luatex
i luatexbase: Basic resource management for LuaTeX code.
i makeindex: Process index output to produce typesettable code.
i makeindex.universal-darwin: universal-darwin files of makeindex
i makeplot: Easy plots from Matlab in LaTeX.
i mathspec: Specify arbitrary fonts for mathematics in XeTeX.
i mdwtools: Miscellaneous tools by Mark Wooding.
i memoir: Typeset fiction, non-fiction and mathematical books.
i metafont: A system for specifying fonts.
i metafont.universal-darwin: universal-darwin files of metafont
i metago: MetaPost output of Go positions.
i metalogo: Extended TeX logo macros.
i metaobj: MetaPost package providing high-level objects.
i metaplot: Plot-manipulation macros for use in Metapost.
i metapost: A development of Metafont for creating graphics.
i metapost.universal-darwin: universal-darwin files of metapost
i metauml: MetaPost library for typesetting UML diagrams.
i mflogo: LaTeX support for Metafont logo fonts.
i mfnfss: Packages to typeset oldgerman and pandora fonts in LaTeX.
i mfpic: Draw Metafont/post pictures from (La)TeX commands.
i mfpic4ode: Macros to draw direction fields and solutions of ODEs.
i mfware: Supporting tools for use with Metafont.
i mfware.universal-darwin: universal-darwin files of mfware
i mh: The MH bundle
i microtype: An interface to the micro-typographic features of pdfTeX.
i misc: (shortdesc missing)
i mp3d: 3D animations.
i mpattern: Patterns in MetaPost.
i mpcolornames: XXXX
i mpgraphics: Process and display MetaPost figures inline.
i mptopdf: mpost to PDF, native MetaPost graphics inclusion
i mptopdf.universal-darwin: universal-darwin files of mptopdf
i ms: Various LaTeX packages by Martin Schroder.
i multido: A loop facility for Generic TeX.
i natbib: Flexible bibliography support.
i ntgclass: "European" versions of standard classes.
i oberdiek: A bundle of packages submitted by Heiko Oberdiek.
i parskip: Layout with zero \parindent, non-zero \parskip.
i path: Typeset paths, making them breakable.
i pdfpages: Include PDF documents in LaTeX.
i pdftex: A TeX extension for direct creation of PDF.
i pdftex-def: Colour and Graphics support for PDFTeX.
i pdftex.universal-darwin: universal-darwin files of pdftex
i pdftricks: Support for pstricks in pdfTeX.
i pedigree-perl: Generate TeX pedigree files from CSV files.
i pedigree-perl.universal-darwin: universal-darwin files of pedigree-perl
i pgf: Create PostScript and PDF graphics in TeX.
i philokalia: A font to typeset the Philokalia Books.
i piechartmp: Draw pie-charts using MetaPost.
i plain: The Plain TeX format.
i polyglossia: Modern multilingual typesetting with XeLaTeX.
i powerdot: A presentation class.
i psbao: Draw Bao diagrams.
i psfrag: Replace strings in encapsulated PostScript figures.
i pslatex: Use PostScript fonts by default.
i psnfss: Font support for common PostScript fonts.
i pspicture: PostScript picture support.
i pst-2dplot: A PSTricks package for drawing 2D curves.
i pst-3d: A PSTricks package for tilting and other pseudo-3D tricks.
i pst-3dplot: Draw 3d curves and graphs using PSTricks.
i pst-abspos: Put objects at an absolute position.
i pst-am: Simulation of modulation and demodulation.
i pst-asr: Typeset autosegmental representations for linguists.
i pst-bar: Produces bar charts using pstricks.
i pst-barcode: Print barcodes using PostScript.
i pst-bezier: Draw Bezier curves.
i pst-blur: PSTricks package for "blurred" shadows.
i pst-bspline: Draw cubic Bspline curves and interpolations.
i pst-calendar: Plot calendars in "fancy" ways.
i pst-circ: PSTricks package for drawing electric circuits.
i pst-coil: A PSTricks package for coils, etc.
i pst-cox: Drawing regular complex polytopes with PSTricks.
i pst-dbicons: Support for drawing ER diagrams.
i pst-diffraction: Print diffraction patterns from various apertures.
i pst-electricfield: Draw electric field and equipotential lines with PStricks.
i pst-eps: Create EPS files from PSTricks figures.
i pst-eucl: Euclidian geometry with pstricks.
i pst-exa: Typeset PSTricks examples, with code.
i pst-fill: Fill or tile areas with PSTricks.
i pst-fr3d: Draw 3-dimensional framed boxes using PSTricks.
i pst-fractal: Draw fractal sets using PSTricks.
i pst-fun: Draw "funny" objects with PSTricks.
i pst-func: PSTricks package for plotting mathematical functions.
i pst-gantt: Draw GANTT charts with pstricks.
i pst-geo: Geographical Projections
i pst-ghsb: (shortdesc missing)
i pst-gr3d: Three dimensional grids with PSTricks.
i pst-grad: Filling with colour gradients, using PStricks.
i pst-graphicx: A pstricks-compatible graphicx for use with Plain TeX.
i pst-infixplot: Using pstricks plotting capacities with infix expressions rather than RPN
i pst-jtree: Typeset complex trees for linguists.
i pst-knot: PSTricks package for displaying knots.
i pst-labo: Draw objects for Chemistry laboratories.
i pst-layout: Page layout macros based on PStricks packages.
i pst-lens: Lenses with PSTricks.
i pst-light3d: 3D lighting effects for pstricks.
i pst-magneticfield: Plotting a magnetic field with PSTricks.
i pst-math: Enhancement of PostScript math operators to use with pstricks
i pst-mirror: Images on a spherical mirror.
i pst-node: Draw connections using pstricks.
i pst-ob3d: Three dimensional objects using PSTricks.
i pst-optexp: Drawing optical experimental setups.
i pst-optic: Drawing optics diagrams.
i pst-osci: Oscgons with PSTricks.
i pst-pad: Draw simple attachment systems with PSTricks.
i pst-pdgr: Draw medical pedigrees using pstricks.
i pst-platon: Platonic solids in PSTricks.
i pst-plot: Plot data using PSTricks.
i pst-poly: Polygons with PSTricks.
i pst-pulley: Plot pulleys, using pstricks.
i pst-qtree: Simple syntax for trees.
i pst-rubans: Draw three-dimensional ribbons.
i pst-sigsys: Support of signal processing-related disciplines.
i pst-slpe: Sophisticated colour gradients.
i pst-solarsystem: Plot the solar system for a specific date.
i pst-solides3d: Draw perspective views of 3D solids.
i pst-soroban: Draw a Soroban using PSTricks.
i pst-spectra: Draw continuum, emission and absorption spectra with PSTricks.
i pst-stru: Civil engineering diagrams, using pstricks.
i pst-support: Assorted support files for use with PStricks.
i pst-text: Text and character manipulation in PSTricks.
i pst-thick: Drawing very thick lines and curves.
i pst-tools: PStricks support functions.
i pst-tree: Trees, using pstricks.
i pst-tvz: Draw trees with more than on root node, using PSTricks.
i pst-uml: UML diagrams with PSTricks.
i pst-vowel: Enable arrows showing diphthongs on vowel charts.
i pst-vue3d: Draw perspective views of three dimensional objects.
i pst2pdf: A script to compile pstricks documents via pdftex.
i pst2pdf.universal-darwin: universal-darwin files of pst2pdf
i pstricks: PostScript macros for TeX.
i pstricks-add: A collection of add-ons and bugfixes for PSTricks.
i pstricks_calcnotes: (shortdesc missing)
i rcs: Use RCS (revision control system) tags in LaTeX documents.
i realscripts: Access OpenType subscript and superscript glyphs.
i revtex: Styles for various Physics Journals.
i roex: (shortdesc missing)
i rotating: Rotation tools, including rotated full-page floats.
i sansmath: Maths in a sans font.
i scheme-basic: basic scheme (plain and latex)
i scheme-minimal: minimal scheme (plain only)
i section: Modifying section commands in LaTeX.
i seminar: Make overhead slides.
i sepnum: Print numbers in a "friendly" format.
i setspace: Set space between lines.
i slideshow: Generate slideshow with MetaPost.
i splines: MetaPost macros for drawing cubic spline interpolants.
i suanpan: MetaPost macros for drawing Chinese and Japanese abaci.
i subfig: Figures broken into subfigures
i synctex: (shortdesc missing)
i synctex.universal-darwin: universal-darwin files of synctex
i tcdialog: (shortdesc missing)
i tcdialog.universal-darwin: universal-darwin files of tcdialog
i tetex: scripts and files originally written for or included in teTeX
i tetex.universal-darwin: universal-darwin files of tetex
i tex: A sophisticated typesetting engine.
i tex-ps: TeX to PostScript generic macros and add-ons.
i tex.universal-darwin: universal-darwin files of tex
i texconfig: (shortdesc missing)
i texconfig.universal-darwin: universal-darwin files of texconfig
i texlive-common: TeX Live documentation (common elements)
i texlive-docindex: top-level TeX Live doc.html, etc.
i texlive-en: TeX Live manual (English)
i texlive-msg-translations: translations of the TeX Live installer and TeX Live Manager
i texlive-scripts: TeX Live infrastructure programs
i texlive-scripts.universal-darwin: universal-darwin files of texlive-scripts
i texlive.infra: basic TeX Live infrastructure
i texlive.infra.universal-darwin: universal-darwin files of texlive.infra
i textcase: Case conversion ignoring mathematics, etc.
i textpath: Setting text along a path with MetaPost.
i threeddice: Create images of dice with one, two, or three faces showing, using MetaPost.
i thumbpdf: Thumbnails for pdfTeX and dvips/ps2pdf.
i thumbpdf.universal-darwin: universal-darwin files of thumbpdf
i times: URW "Base 35" font pack for LaTeX.
i tools: The LaTeX standard tools bundle.
i typehtml: Typeset HTML directly from LaTeX.
i ulem: Package for underlining.
i uml: UML diagrams in LaTeX.
i underscore: Control the behaviour of "_" in text.
i unisugar: Define syntactic sugar for Unicode LaTeX.
i url: Verbatim with URL-sensitive line breaks.
i vaucanson-g: PSTricks macros for drawing automata
i vocaltract: Visualise the vocal tract using LaTeX and PStricks.
i xcolor: Driver-independent color extensions for LaTeX and pdfLaTeX.
i xdvi: A DVI previewer for the X Window System.
i xdvi.universal-darwin: universal-darwin files of xdvi
i xecjk: Support for CJK documents in XeLaTeX.
i xecolor: (shortdesc missing)
i xecyr: Using Cyrillic languages in XeTeX.
i xeindex: Automatic index generation for XeLaTeX.
i xepersian: Persian for LaTeX over XeTeX.
i xesearch: A string finder for XeTeX.
i xetex: Unicode and OpenType-enabled TeX engine.
i xetex-def: Colour and graphics support for XeTeX.
i xetex-itrans: Itrans input maps for use with XeLaTeX.
i xetex-pstricks: Running PStricks under XeTeX.
i xetex.universal-darwin: universal-darwin files of xetex
i xetexconfig: Configuration files for XeTeX.
i xetexfontinfo: Report font features in XeTeX.
i xkeyval: Extension of the keyval package.
i xltxtra: "Extras" for LaTeX users of XeTeX.
i xunicode: Generate Unicode characters from accented glyphs.
"""

_RE_PACKAGE = re.compile('^i ([^:]*): .*$')

def parse_package_list(text):
    ret = set()

    for line in text.split('\n'):
        match = _RE_PACKAGE.match(line)
        if not match:
            if line:
                raise Exception('Unable to parse line ' + repr(line))
            continue
        package_name = match.group(1)
        ret.add(package_name)

    return ret

def main():
    installed_output = subprocess.check_output(
        ['tlmgr', 'list', '--only-installed'])
    default_packages = parse_package_list(DEFAULT_OUTPUT)
    installed_packages = parse_package_list(installed_output)
    print '\n'.join(sorted(installed_packages - default_packages))

if __name__ == '__main__':
    main()

#!/bin/bash

# move a file, leaving a symlink version behind

if (($# != 2)); then
    echo 'RTFSRC.'
    exit 1
fi

# directory -> file: replace
# file -> directory: add filename to link
# file -> file: no problem
# directory -> directory: ok

if [ -f "${1}" ] && [ -d "${2}" ]; then
    set -- "${1}" "${2}/$(basename -- "${1}")"
fi

mv "${1}" "${2}"
ln -ns "${2}" "${1}" || (rm -rf "${1}"; mv "${2}" "{1}")
